<!doctype html>
<html>
<head>
	<meta charset="utf-8">
	<title>Focused MDS</title>
	<link rel="stylesheet" type="text/css" href="focusedMDS_showcase.css">
	<link rel="stylesheet" type="text/css"
	      href="https://fonts.googleapis.com/css?family=Nunito">
	<link rel="stylesheet" type="text/css"
	      href="https://fonts.googleapis.com/css?family=Open+Sans">

	<script src="FocusedMDS/inst/htmlwidgets/lib/optimize_js/optimize_for_javascript.js" type="text/javascript"></script>
	<script src="https://d3js.org/d3.v4.min.js"></script>
	<script src="focusedMDS_showcase.js" type="text/javascript"></script>	
		
</head>
<p style="font-style: italic;">Nov. 2016 / Lea Urpa</p>

<h1>Focused Multidimensional Scaling</h1>

<p>Focused multidimensional scaling (focusedMDS) is a tool for visualizing the multidimensional data contained within a data matrix. Visualization is a key tool in understanding real relationships among data within a dataset, and current static tools for visualization of data from distance matrices via multidimensional scaling can be misleading. FocusedMDS better represents the real relationships among data in a distance matrix.</p>

<h3>Iris data set plot</h3>
<p style="font-style: italic;">Click me!</p>
<div id="first"> </div>

<p>In this graph, you can choose a particular data point (the focus), around which all other points are plotted in their exact distances to the focus (as given in the data matrix). The distances of the non-focus points are plotted as close to their ideal distances as possible. This allows you to move the graph to different perspectives, investigating clusters.</p>

<img src="Fig1.png" alt="Figure1" style="height:300px; width:300px">
<img src="Fig2.png" alt="Figure2" style="height:300px; width:300px">

<p>The data are plotted exactly around the focus point and as exactly as possible to each other by plotting in polar coordinates: the r value is taken directly from the data matrix. The phi for each point is iteratively chosen, beginning with the closest to the focus point outward, by minimizing the disparity between the distances from that point to all the others that have already been plotted on the 2D plane (Dij) and their distances given in the distance matrix (dij), a measure called stress (Dij - dij)^2. Since the points are plotted iteratively, the optimal phi is chosen by univariate mathematical optimization.</p>

<img src="Fig4.png" alt="Figure3" style="height:400px; width:400px">

<p>This gives implications about how the graph is interpreted: those points along a circular grid line are all equally similar to the focus point, but their distances from one another along that circular grid line show their similarity (or dissimilarity) to one another.</p> 
<p>For example, in the picture below we can see that there are many versicolor (blue) and virginica (yellow) samples that are equally similar to the focus sample, but that along that arc the virginica samples are distinct from the versicolor samples (with some overlap).</p>

<img src="Fig3.png" alt="Figure4" style="height:400px; width:400px">

<h2>Make the Iris plot in Rstudio</h2>

<p>To make the Iris plot, use the following code in Rstudio or R:</p>
<div id="somecode">
<code>library(datasets)<br>
	library(focusedMDS)<br>
	<br>
	# Load Edgar Anderson's Iris Data<br>
	data("iris")<br>
	<br>
	# Create a table of measures to compare individuals on<br>
	table <- iris[ , c("Petal.Length", "Petal.Width", "Sepal.Length", "Sepal.Width")]<br>
	<br>
	# Find euclidean distances between flowers based on these measures<br>
	dists <- dist(table)<br>
	<br>
	#Simplest usage: only with dataset input<br>
	focusedMDS(dists)<br>
</code>
</div>
<br>

<div id="second"></div>

<p>In the simplest case, we specify only the distance object. Colors are chosen from a sequential rainbow and labels are automatically assigned. Note we chose to create the distance matrix using petal length, petal width, sepal length, and sepal width measures and calculated simple euclidean distances between each individual flower. The interesting biological questions come from what individuals you choose to compare, and which measures you include when calculating the distance matrix- the focusedMDS function only requires that the input be either a dist object or a square, symmetric matrix.</p>	

<p>Next we will create a vector of color labels based on flower species:</p>
<div id="somecode">
<code>
	# Create labels based on flower species<br>
	colorvector <- as.vector(iris$Species)  # making sure to convert factors to characters<br>
	<br>
	colorvector[colorvector == "setosa"] <- "firebrick"  # colors must be css colors<br>
	colorvector[colorvector == "versicolor"] <- "cornflowerblue"<br>
	colorvector[colorvector == "virginica"] <- "gold" <br>
	       # If you picked a color that isn't CSS, it will show up as black<br>
    <br>
	# Visualization with color labels<br>
	focusedMDS(dists, colors = colorvector)<br>
</code>
</div>
<br>
<div id="third"></div>

<p>Note that the elements in the colors vector must be in the same order as the the column/row names in the distance matrix- otherwise you'll paint the points the wrong color. If you look in the iris data table, you can see that there are 50 setosa species flowers, then 50 versicolor species flowers, then 50 virginica species flowers, so the order of our colors vector here is correct.</p>

<p>Finally, we will create a vector of labels for the points:</p>

<div id="somecode">
<code>
	# Create text labels<br>
	names <- c( paste( rep("setosa", 50), 1:50, sep = "" ),<br>
	 paste( rep("versicolor", 50), 1:50, sep = ""),<br>
	 paste( rep("virginica", 50), 1:50, sep = "")) # Important not to have spaces in name labels<br>
	 <br>
	 focusedMDS( dists, ids = names, colors = colorvector) <br>
</code>
</div>
<br>

<div id="fourth"></div>

<p>Again, the ids vector must be in the same order as column/row names to label the points correctly. The function also has additional specifications for starting focus point (by convention the first id), fixed size of the plot (in pixels), number of background circles, and tolerance for the optimization function.</p>


<p style="font-style: italic;">Nov. 2016 / Lea Urpa</p>


<script>
// Initializing values
var circles = 12;
var size = 400
var tol = 0.001

var first_result = focused_mds(distances, ids, ids[0], tol) 
create_focusedMDS_plot(distances, ids, ids[0], colors, tol, "#first" , first_result)

var second_result = focused_mds(distances, idsNULL, idsNULL[0], tol)
create_focusedMDS_plot(distances, idsNULL, idsNULL[0], colorsNULL, tol, "#second" , second_result)

create_focusedMDS_plot(distances, idsNULL, idsNULL[0], colors, tol, "#third" , second_result)

create_focusedMDS_plot(distances, ids, ids[0], colors, tol, "#fourth", first_result)

</script>

</html>